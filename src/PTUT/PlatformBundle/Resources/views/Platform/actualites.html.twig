{% extends "PTUTPlatformBundle:Platform:layout.html.twig" %}

{% block include %}
    <style>
        .pagination {
            display: inline-block;
        }

        .pagination a {
            color: black;
            float: left;
            padding: 8px 16px;
            text-decoration: none;
            transition: background-color .3s;
            border-radius: 5px;
        }

        .pagination a.active {
            border-radius: 5px;
            background-color: #4CAF50;
            color: white;
        }

        .pagination a:hover:not(.active) {background-color: #ddd;}
    </style>

{%endblock%}

{% block ongletEditions %}active{%endblock%}

{% block body %} 

    <section id="title" class="pomegranate">
        <div class="container">
            <div class="row">
                <div class="col-sm-6">
                    <h1>Actualités</h1>
                    <p>Dernières actualités à la mode !</p>
                </div>
            </div>
        </div>
    </section>
    <section id="blog" class="container">
            
            <div class="col-sm-12">
                <div class="blog">
                    {% for i in 0..3 %}
                        {% if i+(id-1)*4 <= taille-1 %}
                                <div class="blog-item">
                                    {% set num = "asset('bundles/ptutplatform/images/blog/article_" ~ (i+1)+(id-1)*4 ~ ".jpg'" %}
                                    <img class="img-responsive img-blog" src="{{ asset('bundles/ptutplatform/images/blog/article_'~((i+1)+(id-1)*4)~'.jpg' ) }}" width="100%" alt="" />
                                        <div class="blog-content">
                                            <h3>{{ articles[i+(id-1)*4].titre }} </h3>
                                            <div class="entry-meta">
                                                <span><i class="icon-user"></i>{{ articles[i+(id-1)*4].auteur }}</span>
                                                <span><i class="icon-calendar"></i>{{ articles[i+(id-1)*4].date|date('d-m-Y') }}</span>
                                                <span><i class="icon-comment"></i> {{ articles[i+(id-1)*4].commentaires }}</span>
                                            </div>
                                            <p> {{ articles[i+(id-1)*4].presentation }}</p>
                                            {% set page = i+(id-1)*4+1 %}
                                            {% if i == 0 %}
                                            <a class="preview btn btn-default" id="myBtn">Voir plus</a>
                                            {% elseif i == 1 %}
                                            <a class="preview btn btn-default" id="myBtn2">Voir plus</a>
                                            {% elseif i == 2 %}
                                            <a class="preview btn btn-default" id="myBtn3">Voir plus</a>
                                            {% else %}
                                            <a class="preview btn btn-default" id="myBtn4">Voir plus</a>
                                            {% endif %}
                                        </div>
                                    </div>
                                    <!-- Modal -->
                                    {% if i == 0 %}
                                    <div class="modal fade" id="myModal" role="dialog">
                                    {% elseif i == 1 %}
                                    <div class="modal fade" id="myModal2" role="dialog">
                                    {% elseif i == 2 %}
                                    <div class="modal fade" id="myModal3" role="dialog">
                                    {% else %}
                                    <div class="modal fade" id="myModal4" role="dialog">
                                    {% endif %}
                                        <div class="modal-dialog">

                                          <!-- Modal content-->
                                          <div class="modal-content">
                                            <div class="modal-header">
                                              <button type="button" class="close" data-dismiss="modal">&times;</button>
                                              <h2 class="modal-title">{{ articles[i+(id-1)*4].titre }}</h2>
                                            </div>
                                            <div class="modal-body">
                                                <div class="blog">
                                                    <div class="blog-item">
                                                        <img class="img-responsive img-blog" src="{{ asset('bundles/ptutplatform/images/blog/article_'~((i+1)+(id-1)*4)~'.jpg' ) }}" width="100%" alt="" />
                                                        <div class="blog-content">
                                                            <div>
                                                                
                                                                <div class="entry-meta">
                                                                    <span><i class="icon-user"></i>{{ articles[i+(id-1)*4].auteur }}</span>
                                                                    <span><i class="icon-calendar"></i>{{ articles[i+(id-1)*4].date|date('d-m-Y') }}</span>
                                                                    <span><i class="icon-comment"></i> {{ articles[i+(id-1)*4].commentaires }}</span>
                                                                </div>
                                                                <p class="lead"> {{ articles[i+(id-1)*4].presentation }}</p>
                                                              {% include "PTUTPlatformBundle:Platform:articles/article_" ~ page ~ ".html.twig" %}
                                                            </div>
                                                            <div id="comments">
                                                                <div id="comments-list">
                                                                    <h3>{{ articles[i+(id-1)*4].commentaires }} Commentaires</h3>
                                                                    <form method="post" action="" >
                                                                        <input type="hidden" value="{{ articles[i+(id-1)*4].id }}" name="article">
                                                                        <input type="hidden" value="-1" name="parent">
                                                                        <div class="form-group">
                                                                            <label for="author">Auteur :</label>
                                                                            <input class="form-control" type="text" value="Anonyme" name="author">
                                                                        </div>
                                                                        <div class="form-group">
                                                                            <label for="content">Commentaire :</label>
                                                                            <textarea class="form-control" placeholder="Contenu" name="content"></textarea>
                                                                        </div>
                                                                        <input class="btn btn-default" type="submit" value="Commenter">
                                                                    </form>
                                                                    {% for u in 0..(tailleCom-1) %}
                                                                    {% if commentaire[u].reponse == -1 and commentaire[u].article == articles[i+(id-1)*4].id %}
                                                                    <div class="media">
                                                                        <div class="pull-left">
                                                                            <img class="avatar img-circle" src="images/blog/avatar1.png" alt="">
                                                                        </div>
                                                                        <div class="media-body">
                                                                            <div class="well">
                                                                                <div class="media-heading">
                                                                                    <strong>{{ commentaire[u].auteur }}</strong>&nbsp; <small>{{ commentaire[u].date|date('d-m-Y H:i:s') }}</small>
                                                                                    <a class="pull-right" data-toggle="collapse" data-target="#reply{{ commentaire[u].id }}"><i class="icon-repeat"></i> Reply</a>
                                                                                </div>
                                                                                <p>{{ commentaire[u].contenu }}</p>
                                                                            </div>
                                                                            <div class="col-sm-10 pull-right">
                                                                                <form class="collapse" method="post" action="" id="reply{{ commentaire[u].id }}">
                                                                                    <input type="hidden" value="{{ articles[i+(id-1)*4].id }}" name="article">
                                                                                    <input type="hidden" value="{{ commentaire[u].id }}" name="parent">
                                                                                    <div class="form-group">
                                                                                        <label for="author">Auteur :</label>
                                                                                        <input class="form-control" type="text" value="Anonyme" name="author">
                                                                                    </div>
                                                                                    <div class="form-group">
                                                                                        <label for="content">Commentaire :</label>
                                                                                        <textarea class="form-control" placeholder="Contenu" name="content"></textarea>
                                                                                    </div>
                                                                                    <input class="btn btn-default" type="submit" value="Commenter">
                                                                                </form>
                                                                                {% for j in 0..(tailleCom-1) %}
                                                                                {% if commentaire[j].reponse == commentaire[u].id %}
                                                                                <div class="media">
                                                                                    <div class="pull-left">
                                                                                        <img class="avatar img-circle" src="images/blog/avatar1.png" alt="">
                                                                                    </div>
                                                                                    <div class="media-body">
                                                                                        <div class="well">
                                                                                            <div class="media-heading">
                                                                                                <strong>{{ commentaire[j].auteur }}</strong>&nbsp; <small>{{ commentaire[j].date|date('d-m-Y H:i:s') }}</small>
                                                                                            </div>
                                                                                            <p>{{ commentaire[j].contenu }}</p>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                {% endif %}
                                                                                {% endfor %}
                                                                            </div><!--/.media-->
                                                                        </div>
                                                                    </div><!--/.media-->
                                                                    {% endif %}
                                                                    {% endfor %}
                                                                </div><!--/#comments-list-->
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                              </div>
                                            <div class="modal-footer">
                                              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                            </div>
                                          </div>

                                        </div>
                                </div>

                            {% endif %}

                        {% endfor %}
                        </div>
                    </div>
                </div>
                <center>
                <div class="pagination">
                {% set prev = id - 1 %}
                {% set next = id + 1 %}
                    
                {% if id != 1 %}
                    <a href="{{path('ptut_platform_view_id', {'id': prev })}}">&laquo;</a>
                {% else %}
                    <a href="#">&laquo;</a>
                {% endif %}
                {% if id >= 3 %}
                    {% set idMoins2 = id - 2%}
                     <a href="{{path('ptut_platform_view_id', {'id': idMoins2 })}}">{{idMoins2}}</a>
                {% endif %}
                {% if id >= 2 %}
                    <a href="{{path('ptut_platform_view_id', {'id': prev })}}">{{prev}}</a>
                {% endif %}
                    <a href="" class="active">{{id}}</a>
                {% if id+1 <= (taille//4)+1 %}
                    <a href="{{path('ptut_platform_view_id', {'id': next })}}">{{next}}</a>
                {% endif %}
                {% if id+2 <= (taille//4)+1 %}
                    {% set idPlus2 = id + 2%}
                    <a href="{{path('ptut_platform_view_id', {'id': idPlus2 })}}">{{idPlus2}}</a>
                {% endif %}
                {% if id < (taille//4)+1 %}
                    <a href="{{path('ptut_platform_view_id', {'id': next })}}">&raquo;</a>
                {% else %}
                    <a href="#">&raquo;</a>
                {% endif %}
                </div>
                </center>
        </div>
    </section>
{%endblock%}